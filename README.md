# 🧠 学习心理诊断工具

[![Python 3.11+](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)
[![Streamlit](https://img.shields.io/badge/streamlit-1.32+-red.svg)](https://streamlit.io/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

一款"小而美"的 AI 原生学习心理诊断工具。通过 3-5 轮深度对话，利用语义投射技术量化学生学习力背后的四个核心心理维度。

## 🎯 产品定位

### 核心价值
- **精准诊断**：通过 AI 深度对话，量化学生的心理维度
- **实时反馈**：每轮对话后实时更新心理维度评分
- **个性化方案**：生成学生版和家长版的定制化报告
- **易用易懂**：百分制评分，直观易理解

### 应用场景
- 学生学习困难诊断
- 心理咨询师辅助工具
- 教育机构学生评估
- AI 大赛演示项目

## ✨ 产品特性

### 核心功能
- **三扇门场景入口**
  - 失意之径：努力后却考砸了
  - 深谷挑战：深夜遇难题卡住
  - 意志荒漠：想放弃去刷视频

- **左图右谈交互**
  - 左侧：动态雷达图 + 语义透视窗 + 分值卡片
  - 右侧：气泡式对话 + 智能输入框 + 操作按钮

- **实时心理维度量化**
  - 归因风格：如何解释失败
  - 自我效能感：对自己能力的信心
  - 认知负荷：心理压力和信息处理能力
  - 元认知：对学习过程的认知和反思

- **智能追问逻辑**
  - 字数检测：<5 字触发澄清
  - 澄清式引导：帮助学生深入思考

- **深度透视报告**
  - 学生版：心理动力分析 + 24 小时行动处方
  - 家长版：非暴力沟通话术

### 技术栈
- **前端框架**：Streamlit 1.32+
- **可视化**：Plotly 5.18+（动态雷达图）
- **AI 驱动**：九章大模型 / GPT-4o API（待集成）
- **状态管理**：Streamlit Session State
- **评分系统**：0-100 百分制

## 🚀 快速开始

### 前置要求
- Python 3.11 或更高版本
- pip 包管理工具

### 1. 克隆项目
```bash
git clone https://github.com/yourusername/study-mirror.git
cd study-mirror
```

### 2. 创建虚拟环境
```bash
# macOS/Linux
python3 -m venv venv
source venv/bin/activate

# Windows
python -m venv venv
venv\Scripts\activate
```

### 3. 安装依赖
```bash
pip install -r requirements.txt
```

### 4. 运行应用
```bash
streamlit run app.py
```

应用将在 `http://localhost:8501` 启动

## 📁 项目结构

```
study-mirror/
├── app.py                      # 主应用程序（~600 行）
├── requirements.txt            # 依赖管理
├── README.md                   # 项目文档
├── OPTIMIZATION.md             # 页面优化文档
├── BEAUTY_OPTIMIZATION.md      # 美观度优化文档
├── .gitignore                  # Git 忽略文件
└── config/                     # 配置文件（待创建）
    ├── scenarios.json          # 场景配置
    └── prompts.json            # AI Prompt 配置
```

## 🎨 页面设计

### 首页（三扇门）
```
┌─────────────────────────────────────────┐
│     🧠 学习心理诊断工具                  │
│   通过深度对话，发现你的学习心理密码     │
├─────────────────────────────────────────┤
│  ┌──────────┐  ┌──────────┐  ┌──────────┐
│  │ 😔 失意  │  │ 🌙 深谷  │  │ 📱 意志  │
│  │ 之径     │  │ 挑战     │  │ 荒漠     │
│  └──────────┘  └──────────┘  └──────────┘
└─────────────────────────────────────────┘
```

### 对话页面（左图右谈）
```
┌─────────────────────────────────────────────────────┐
│ ← 返回首页  │  🧠 失意之径  │  进度: 2/4 轮        │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ┌──────────────────┐  ┌──────────────────────┐   │
│  │ 📊 学习心理维度  │  │ 💬 深度对话          │   │
│  │                  │  │                      │   │
│  │  [雷达图]        │  │ 🧠 心理咨询师:       │   │
│  │                  │  │ 你好，很高兴认识你  │   │
│  │ 🔍 捕捉到:       │  │                      │   │
│  │ 能力内化归因      │  │ 👤 你:               │   │
│  │                  │  │ 我最近考试失利了...  │   │
│  │ 📈 维度分值      │  │                      │   │
│  │ ┌──────┬──────┐  │  │ ─────────────────    │   │
│  │ │ 归因 │ 效能 │  │  │ [输入框]             │   │
│  │ │ 风格 │ 感   │  │  │                      │   │
│  │ └──────┴──────┘  │  │ [📤 提交] [🏠 返回] │   │
│  │ ┌──────┬──────┐  │  │                      │   │
│  │ │ 认知 │ 元   │  │  │ [📋 生成报告]        │   │
│  │ │ 负荷 │ 认知 │  │  │                      │   │
│  │ └──────┴──────┘  │  │                      │   │
│  └──────────────────┘  └──────────────────────┘   │
│                                                     │
└─────────────────────────────────────────────────────┘
```

## 🔌 API 数据协议

AI 每一轮必须返回以下 JSON 结构：

```json
{
  "dialogue": "AI 对学生的回复文字",
  "scores": {
    "归因风格": 50,
    "自我效能感": 55,
    "认知负荷": 45,
    "元认知": 60
  },
  "is_finished": false,
  "analysis_log": "捕捉到：能力内化归因、自我反思能力"
}
```

### 字段说明
- `dialogue`：AI 的回复文本（必需）
- `scores`：四个维度的评分，范围 0-100（必需）
- `is_finished`：是否完成诊断（可选，默认 false）
- `analysis_log`：心理学分析日志（可选）

## 🛠️ 开发路线图

### Phase 1 - 基础框架（✅ 已完成）
- [x] 项目初始化和依赖配置
- [x] 三扇门场景入口设计
- [x] 左图右谈布局实现
- [x] 动态雷达图开发
- [x] 对话历史管理
- [x] JSON 解析器
- [x] 页面样式优化（80% 宽度）
- [x] 美观度优化（渐变、阴影、hover 效果）

### Phase 2 - AI 集成（🔄 进行中）
- [ ] 集成九章大模型 API
- [ ] 集成 GPT-4o API
- [ ] 完善 System Prompt（心理学理论）
- [ ] 实现流式输出（streaming）
- [ ] 错误重试机制

### Phase 3 - 报告生成（⏳ 待开发）
- [ ] 深度透视报告生成
- [ ] 学生版报告（心理动力分析 + 行动处方）
- [ ] 家长版报告（非暴力沟通话术）
- [ ] 报告导出功能（PDF/Word）
- [ ] 数据可视化（历史趋势图）

### Phase 4 - 数据持久化（⏳ 待开发）
- [ ] 用户认证系统
- [ ] 对话历史存储（数据库）
- [ ] 报告存档功能
- [ ] 数据分析仪表板

## 📊 性能指标

| 指标 | 目标 | 状态 |
|------|------|------|
| 首屏加载时间 | < 2s | ✅ |
| 对话响应时间 | < 3s | ⏳ |
| 页面占屏幕宽度 | 80% | ✅ |
| 评分系统 | 0-100 | ✅ |
| 对话轮数 | 3-5 轮 | ✅ |

## 🎨 设计理念

### 颜色系统
- **主色**：紫蓝色 (#667eea) - 专业、信任
- **AI 气泡**：蓝紫色渐变 - 温暖、专业
- **用户气泡**：绿色渐变 - 积极、成长
- **语义窗**：黄色渐变 - 提示、关键

### 交互设计
- **Hover 效果**：分值卡片向上浮起
- **Focus 效果**：输入框有紫蓝色光晕
- **过渡动画**：所有交互都是平滑的
- **视觉反馈**：每个操作都有明确的反馈

## 📝 使用说明

### 首页操作
1. 阅读三个场景描述
2. 选择符合自己情况的场景
3. 点击"进入"按钮

### 对话操作
1. 阅读 AI 的问题
2. 在输入框中详细描述你的想法和感受
3. 点击"📤 提交回答"按钮
4. 观察左侧雷达图和分值卡片的实时更新
5. 重复 3-4 轮对话
6. 点击"📋 生成深度透视报告"查看结果

### 注意事项
- 回答字数需要 ≥ 5 字（触发澄清逻辑）
- 建议进行 4 轮对话以获得更准确的诊断
- 所有数据仅用于演示，不会被保存

## 🔐 环境变量配置

创建 `.env` 文件（可选）：
```bash
# AI API 配置
OPENAI_API_KEY=your_openai_api_key
JIUZHANG_API_KEY=your_jiuzhang_api_key

# Streamlit 配置
STREAMLIT_SERVER_PORT=8501
STREAMLIT_SERVER_HEADLESS=true
```

## 🐛 常见问题

### Q: 如何修改场景描述？
A: 编辑 `app.py` 中的 `SCENARIOS` 字典，修改对应场景的 `system_prompt`。

### Q: 如何集成真实 AI API？
A: 替换 `simulate_ai_response()` 函数，调用真实的 API 并返回标准 JSON 格式。

### Q: 如何自定义评分逻辑？
A: 修改 `simulate_ai_response()` 函数中的评分计算逻辑。

### Q: 如何添加新的场景？
A: 在 `SCENARIOS` 字典中添加新的场景，并在首页添加对应的按钮。

## 📞 技术支持

- 📧 Email: support@example.com
- 🐛 Issue: [GitHub Issues](https://github.com/yourusername/study-mirror/issues)
- 💬 Discussion: [GitHub Discussions](https://github.com/yourusername/study-mirror/discussions)

## 🤝 贡献指南

欢迎提交 Pull Request 或 Issue！

### 开发流程
1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

## 📄 许可证

本项目采用 MIT License - 详见 [LICENSE](LICENSE) 文件

## 🙏 致谢

- Streamlit 团队提供的优秀框架
- Plotly 提供的数据可视化库
- 所有贡献者和用户的支持

## 📈 项目统计

- 📝 代码行数：~600 行
- 🎨 CSS 样式：~150 行
- 📚 文档：3 个文档文件
- ⏱️ 开发时间：~8 小时
- 🎯 功能完成度：60%

---

**Made with ❤️ for AI Education**

⭐ 如果这个项目对你有帮助，请给个 Star！

